PS C:\Users\hp\Documents\GitHub\oncodb-search\scraping> python .\pubmed-scrape-api.py
üîç Searching PubMed for: "cancer immunotherapy clinical trial" (max 20000 results)
‚úÖ Fetched 100 PMIDs so far...
‚ö†Ô∏è Retry 1/5 in 10s...
‚úÖ Fetched 200 PMIDs so far...
‚úÖ Fetched 300 PMIDs so far...
‚úÖ Fetched 400 PMIDs so far...
‚úÖ Fetched 500 PMIDs so far...
‚ö†Ô∏è Retry 1/5 in 10s...
‚úÖ Fetched 600 PMIDs so far...
‚úÖ Fetched 700 PMIDs so far...
‚úÖ Fetched 800 PMIDs so far...
‚úÖ Fetched 900 PMIDs so far...
‚úÖ Fetched 1000 PMIDs so far...
‚úÖ Fetched 1100 PMIDs so far...
‚úÖ Fetched 1200 PMIDs so far...
‚úÖ Fetched 1300 PMIDs so far...
‚úÖ Fetched 1400 PMIDs so far...
‚úÖ Fetched 1500 PMIDs so far...
‚úÖ Fetched 1600 PMIDs so far...
‚úÖ Fetched 1700 PMIDs so far...
‚úÖ Fetched 1800 PMIDs so far...
‚úÖ Fetched 1900 PMIDs so far...
‚úÖ Fetched 2000 PMIDs so far...
‚úÖ Fetched 2100 PMIDs so far...
‚úÖ Fetched 2200 PMIDs so far...
‚úÖ Fetched 2300 PMIDs so far...
‚úÖ Fetched 2400 PMIDs so far...
‚úÖ Fetched 2500 PMIDs so far...
‚úÖ Fetched 2600 PMIDs so far...
‚úÖ Fetched 2700 PMIDs so far...
‚úÖ Fetched 2800 PMIDs so far...
‚úÖ Fetched 2900 PMIDs so far...
‚úÖ Fetched 3000 PMIDs so far...
‚úÖ Fetched 3100 PMIDs so far...
‚úÖ Fetched 3200 PMIDs so far...
‚úÖ Fetched 3300 PMIDs so far...
‚úÖ Fetched 3400 PMIDs so far...
‚úÖ Fetched 3500 PMIDs so far...
‚úÖ Fetched 3600 PMIDs so far...
‚úÖ Fetched 3700 PMIDs so far...
‚úÖ Fetched 3800 PMIDs so far...
‚úÖ Fetched 3900 PMIDs so far...
‚úÖ Fetched 4000 PMIDs so far...
‚úÖ Fetched 4100 PMIDs so far...
‚úÖ Fetched 4200 PMIDs so far...
‚úÖ Fetched 4300 PMIDs so far...
‚úÖ Fetched 4400 PMIDs so far...
‚úÖ Fetched 4500 PMIDs so far...
‚úÖ Fetched 4600 PMIDs so far...
‚úÖ Fetched 4700 PMIDs so far...
‚úÖ Fetched 4800 PMIDs so far...
‚úÖ Fetched 4900 PMIDs so far...
‚úÖ Fetched 5000 PMIDs so far...
‚úÖ Fetched 5100 PMIDs so far...
‚úÖ Fetched 5200 PMIDs so far...
‚úÖ Fetched 5300 PMIDs so far...
‚úÖ Fetched 5400 PMIDs so far...
‚úÖ Fetched 5500 PMIDs so far...
‚úÖ Fetched 5600 PMIDs so far...
‚úÖ Fetched 5700 PMIDs so far...
‚úÖ Fetched 5800 PMIDs so far...
‚úÖ Fetched 5900 PMIDs so far...
‚úÖ Fetched 6000 PMIDs so far...
‚úÖ Fetched 6100 PMIDs so far...
‚úÖ Fetched 6200 PMIDs so far...
‚úÖ Fetched 6300 PMIDs so far...
‚úÖ Fetched 6400 PMIDs so far...
‚úÖ Fetched 6500 PMIDs so far...
‚úÖ Fetched 6600 PMIDs so far...
‚úÖ Fetched 6700 PMIDs so far...
‚úÖ Fetched 6800 PMIDs so far...
‚úÖ Fetched 6900 PMIDs so far...
‚úÖ Fetched 7000 PMIDs so far...
‚úÖ Fetched 7100 PMIDs so far...
‚úÖ Fetched 7200 PMIDs so far...
‚úÖ Fetched 7300 PMIDs so far...
‚úÖ Fetched 7400 PMIDs so far...
‚úÖ Fetched 7500 PMIDs so far...
‚úÖ Fetched 7600 PMIDs so far...
‚úÖ Fetched 7700 PMIDs so far...
‚úÖ Fetched 7800 PMIDs so far...
‚úÖ Fetched 7900 PMIDs so far...
‚úÖ Fetched 8000 PMIDs so far...
‚úÖ Fetched 8100 PMIDs so far...
‚úÖ Fetched 8200 PMIDs so far...
‚úÖ Fetched 8300 PMIDs so far...
‚úÖ Fetched 8400 PMIDs so far...
‚úÖ Fetched 8500 PMIDs so far...
‚úÖ Fetched 8600 PMIDs so far...
‚úÖ Fetched 8700 PMIDs so far...
‚úÖ Fetched 8800 PMIDs so far...
‚úÖ Fetched 8900 PMIDs so far...
‚úÖ Fetched 9000 PMIDs so far...
‚úÖ Fetched 9100 PMIDs so far...
‚úÖ Fetched 9200 PMIDs so far...
‚úÖ Fetched 9300 PMIDs so far...
‚úÖ Fetched 9400 PMIDs so far...
‚úÖ Fetched 9500 PMIDs so far...
‚úÖ Fetched 9600 PMIDs so far...
‚úÖ Fetched 9700 PMIDs so far...
‚úÖ Fetched 9800 PMIDs so far...
‚úÖ Fetched 9900 PMIDs so far...
‚úÖ Fetched 9999 PMIDs so far...
‚ö†Ô∏è Retry 1/5 in 10s...
‚ö†Ô∏è Retry 2/5 in 20s...
‚ö†Ô∏è Retry 3/5 in 40s...
‚ö†Ô∏è Retry 4/5 in 60s...
‚ö†Ô∏è Retry 5/5 in 60s...
üì• Fetched 9999 PMIDs. Getting article details...
‚ö†Ô∏è Retry 1/5 in 10s...
‚ö†Ô∏è Retry 1/5 in 10s...
‚ö†Ô∏è Retry 1/5 in 10s...
‚ö†Ô∏è Retry 1/5 in 10s...
‚ö†Ô∏è Retry 2/5 in 20s...
‚ö†Ô∏è Retry 1/5 in 10s...
‚úÖ Done. Saved 9984 articles to pubmed_articles.json
PS C:\Users\hp\Documents\GitHub\oncodb-search\scraping>





Ottimo lavoro: lo scraping ha funzionato correttamente fino al limite massimo che PubMed consente per una singola richiesta, ovvero **9999 record**.

Hai anche raggiunto una **quota-limite** (probabilmente perch√© non hai ancora impostato l‚ÄôAPI key oppure hai superato i limiti orari/giornalieri anche con la chiave). Questo spiega i `‚ö†Ô∏è Retry` e il fatto che siano stati salvati **9984 articoli** su 9999 PMIDs.

### Prossimi passi consigliati:

---

#### ‚úÖ 1. **Imposta l'API Key**

Ti consiglio vivamente di usare una API Key NCBI per ottenere:

* **Meno limiti di throttling**.
* Fino a **10 richieste al secondo** (contro 3 al secondo senza chiave).

üëâ Vai qui per ottenerla:
[https://www.ncbi.nlm.nih.gov/account/settings/](https://www.ncbi.nlm.nih.gov/account/settings/)

1. Crea un account (se non ne hai uno).
2. Vai nella sezione **API Key Management**.
3. Clicca su **Create API Key**.
4. Copia la chiave generata.

Nel tuo `.env` (da mettere nella cartella dove esegui lo script), scrivi:

```dotenv
NCBI_API_KEY=tuachiavequi
```

Poi assicurati che `python-dotenv` sia installato:

```bash
pip install python-dotenv
```

E carica le variabili all‚Äôinizio dello script, se non lo fai gi√†:

```python
from dotenv import load_dotenv
load_dotenv()
```

---

#### ‚úÖ 2. **Scraping oltre i 10.000 articoli**

PubMed **limita a 10.000 risultati per query**. Per superare questo:

* Usa **query multiple pi√π specifiche** (es. con intervalli temporali o filtri per rivista, autore, tipo di studio).

Esempio:

```bash
python pubmed-scrape-api.py --query "cancer immunotherapy clinical trial AND 2023[dp]"
```

oppure

```bash
python pubmed-scrape-api.py --query "cancer immunotherapy clinical trial AND Nature[ta]"
```

Oppure puoi segmentare per anno:

```python
for year in range(2015, 2025):
    query = f"cancer immunotherapy clinical trial AND {year}[dp]"
    # Lancia lo script con quella query
```

---

#### ‚úÖ 3. **Controlla `pubmed_articles.json`**

Verifica che il contenuto abbia:

* Titolo (`Title`)
* Abstract
* Autori
* Journal
* DOI (se presente)
* PMID

Se ti servono ulteriori strutture o formati (CSV, SQLite, MongoDB, etc.), fammelo sapere e te li preparo.

---

Vuoi che ora ti aiuti a fare un **batch automatico per anni**, tipo 2010‚Äì2024, cos√¨ arrivi ben oltre 20.000 articoli?
